<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GOWIN - GOLDEN THE GOAT</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Cairo', sans-serif; background-color: #0f172a; }
        .goat-gradient { background: linear-gradient(135deg, #eab308 0%, #a16207 100%); }
    </script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø±Ø¨Ø· Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ (Ù…Ù† Ø§Ù„ØµÙˆØ±)
        const API_CONFIG = {
            endpoint: 'https://api.jsonbin.io/v3/b/698ec55bd0ea881f40b6b5e3',
            key: '$2a$10$zP2nglkzKrG1K81/D3uY1ejRP73C/zxIpE9QiFtYPOS2pU9saHnU.'
        };

        const QUESTIONS = [
            { q: "Ù…Ø§ Ù‡Ùˆ Ù„Ù‚Ø¨ Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø£ÙØ¶Ù„ ÙÙŠ Ø§Ù„ØªØ§Ø±ÙŠØ®ØŸ", a: ["GOAT", "Fish", "Lion", "Tiger"], c: 0 },
            { q: "Ù…Ø§ Ù‡ÙŠ Ø¹Ø§ØµÙ…Ø© Ø§Ù„ÙŠØ§Ø¨Ø§Ù†ØŸ", a: ["Ø·ÙˆÙƒÙŠÙˆ", "Ø³ÙˆÙ„", "Ø¨ÙƒÙŠÙ†", "Ø§Ù„Ø±ÙŠØ§Ø¶"], c: 0 },
            { q: "ÙƒÙ… Ø¹Ø¯Ø¯ Ù‚Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ", a: ["5", "6", "7", "8"], c: 2 }
        ];

        function App() {
            const [players, setPlayers] = useState([]);
            const [isPlaying, setIsPlaying] = useState(false);
            const [score, setScore] = useState(0);
            const [qIndex, setQIndex] = useState(0);
            const [userName, setUserName] = useState('');

            // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† jsonbin
            useEffect(() => {
                fetch(`${API_CONFIG.endpoint}/latest`, {
                    headers: { 'X-Master-Key': API_CONFIG.key }
                })
                .then(res => res.json())
                .then(data => {
                    if (data.record && data.record.players) setPlayers(data.record.players);
                })
                .catch(err => console.log("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¬Ù„Ø¨:", err));
            }, []);

            const startGame = () => {
                const name = prompt("Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ ÙŠØ§ Ø¨Ø·Ù„:");
                if (name) {
                    setUserName(name);
                    setIsPlaying(true);
                    setScore(0);
                    setQIndex(0);
                }
            };

            const handleAnswer = (idx) => {
                if (idx === QUESTIONS[qIndex].c) setScore(s => s + 10);
                
                if (qIndex < QUESTIONS.length - 1) {
                    setQIndex(qIndex + 1);
                } else {
                    finishGame();
                }
            };

            const finishGame = () => {
                setIsPlaying(false);
                const newPlayer = { name: userName, score: score + (userName === 'Lil' ? 10 : 0) }; // Ù…ÙŠØ²Ø© Ø¨Ø³ÙŠØ·Ø© Ù„Ù€ Lil
                const updated = [...players, newPlayer].sort((a, b) => b.score - a.score).slice(0, 10);
                setPlayers(updated);

                // Ø­ÙØ¸ ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø©
                fetch(API_CONFIG.endpoint, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json', 'X-Master-Key': API_CONFIG.key },
                    body: JSON.stringify({ players: updated })
                });
                alert(`Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©! Ù†Ù‚Ø§Ø·Ùƒ: ${score}`);
            };

            return (
                <div className="min-h-screen text-white p-4 flex flex-col items-center">
                    <header className="w-full max-w-md flex justify-between items-center py-6">
                        <div className="text-2xl font-black text-yellow-500">GOWIN</div>
                        <div className="bg-slate-800 px-4 py-1 rounded-full text-xs">Cloud Sync Active</div>
                    </header>

                    <main className="w-full max-w-md">
                        {!isPlaying ? (
                            <div className="space-y-6">
                                <div className="goat-gradient p-8 rounded-[2rem] text-center shadow-2xl">
                                    <h1 className="text-4xl font-black text-slate-900 mb-2">GOLDEN GOAT</h1>
                                    <p className="text-slate-900/80 font-bold">ØªØ­Ø¯Ù‰ Ø§Ù„Ø¬Ù…ÙŠØ¹ ÙˆØªØµØ¯Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</p>
                                </div>
                                
                                <button onClick={startGame} className="w-full bg-yellow-500 hover:bg-yellow-400 text-black font-black py-4 rounded-2xl text-xl transition-all shadow-lg">
                                    Ø¯Ø®ÙˆÙ„ Ø§Ù„ØªØ­Ø¯ÙŠ ğŸš€
                                </button>

                                <div className="bg-slate-800/50 border border-slate-700 rounded-3xl p-6">
                                    <h3 className="text-center font-bold text-yellow-500 mb-4">ğŸ† Ø£ÙØ¶Ù„ 10 Ù„Ø§Ø¹Ø¨ÙŠÙ†</h3>
                                    <div className="space-y-3">
                                        {players.map((p, i) => (
                                            <div key={i} className="flex justify-between items-center bg-slate-900/50 p-3 rounded-xl border border-slate-800">
                                                <span className="font-bold text-slate-400">#{i+1} {p.name}</span>
                                                <span className="text-yellow-500 font-black">{p.score}</span>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        ) : (
                            <div className="bg-slate-800 p-8 rounded-[2rem] border-2 border-yellow-500/50 shadow-2xl animate-pulse-once">
                                <div className="text-center mb-8">
                                    <span className="bg-yellow-500 text-black px-4 py-1 rounded-full text-xs font-black">Ø³Ø¤Ø§Ù„ {qIndex + 1}</span>
                                    <h2 className="text-2xl font-bold mt-4">{QUESTIONS[qIndex].q}</h2>
                                </div>
                                <div className="grid gap-4">
                                    {QUESTIONS[qIndex].a.map((opt, i) => (
                                        <button key={i} onClick={() => handleAnswer(i)} className="w-full bg-slate-700 hover:bg-slate-600 p-4 rounded-xl text-right font-bold transition-colors">
                                            {opt}
                                        </button>
                                    ))}
                                </div>
                            </div>
                        )}
                    </main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

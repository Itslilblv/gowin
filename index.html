<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gowin Pro - Ultimate</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root { --gold: #ffd700; --bg: #050a14; }

        /* Ø®Ù„ÙÙŠØ© Ù…ØªØ­Ø±ÙƒØ© Ø¥Ø¨Ø¯Ø§Ø¹ÙŠØ© */
        body { 
            background: linear-gradient(-45deg, #050a14, #0a192f, #001f3f, #050a14);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            color: white; font-family: 'Cairo', sans-serif; text-align: center; margin: 0; min-height: 100vh;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Ø§Ù„Ù„ÙˆØ¬Ùˆ Ø§Ù„Ù…ØªØ­Ø±Ùƒ */
        .logo-container { padding: 40px 20px; }
        .main-logo {
            font-size: 3.5rem; font-weight: 900; color: var(--gold);
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
            animation: logoPulse 2s infinite ease-in-out;
            display: inline-block; letter-spacing: 5px;
        }

        @keyframes logoPulse {
            0%, 100% { transform: scale(1); filter: drop-shadow(0 0 5px var(--gold)); }
            50% { transform: scale(1.1); filter: drop-shadow(0 0 25px var(--gold)); }
        }

        .goat-banner { 
            background: rgba(255, 215, 0, 0.9); color: black; padding: 10px; 
            font-weight: 900; width: 100%; box-shadow: 0 5px 20px rgba(0,0,0,0.5);
        }

        /* Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø§Ù„Ø²Ø¬Ø§Ø¬ÙŠØ© */
        .nav-tabs {
            display: flex; justify-content: center; background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px); sticky: top; z-index: 1000; border-bottom: 1px solid rgba(255,215,0,0.3);
        }
        .tab-item {
            flex: 1; padding: 15px; cursor: pointer; font-weight: bold; transition: 0.3s;
            color: #aaa; border-bottom: 3px solid transparent;
        }
        .tab-item.active { color: var(--gold); border-bottom-color: var(--gold); background: rgba(255,215,0,0.1); }

        /* Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª */
        .player-card {
            background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(5px);
            margin: 12px auto; padding: 15px; border-radius: 15px; 
            display: flex; justify-content: space-between; align-items: center; 
            width: 90%; max-width: 500px; border: 1px solid rgba(255,215,0,0.2);
            transition: 0.3s;
        }
        .top-goat-card { border: 2px solid var(--gold); box-shadow: 0 0 20px rgba(255,215,0,0.2); background: rgba(255,215,0,0.1); }

        .play-btn {
            background: var(--gold); color: black; padding: 20px 60px; border: none;
            border-radius: 50px; font-weight: 900; font-size: 1.5rem; cursor: pointer;
            box-shadow: 0 10px 30px rgba(255,215,0,0.4); margin: 30px 0;
        }

        #game-overlay { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: var(--bg); z-index: 2000; display: none; flex-direction: column; align-items: center; justify-content: center;
        }
        
        .option-btn {
            width: 85%; max-width: 400px; padding: 20px; margin: 10px;
            border: 2px solid var(--gold); background: none; color: white;
            border-radius: 15px; cursor: pointer; font-size: 1.2rem; font-weight: 900;
        }
        
        .hidden { display: none !important; }
    </style>
</head>
<body onclick="startMusicOnce()">

    <audio id="bgMusic" loop src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-15.mp3"></audio>
    <audio id="winSnd" src="https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3"></audio>
    <audio id="loseSnd" src="https://assets.mixkit.co/active_storage/sfx/2019/2019-preview.mp3"></audio>

    <div class="logo-container">
        <div class="main-logo">GOWIN PRO</div>
    </div>

    <div class="goat-banner">ğŸ† THE GOLDEN GOAT: <span id="top-goat-display">...</span> ğŸ†</div>

    <div class="nav-tabs">
        <div class="tab-item active" onclick="showTab('leaderboard', this)">ğŸ“Š Ø§Ù„Ù…ØªØµØ¯Ø±ÙˆÙ†</div>
        <div class="tab-item" onclick="showTab('info', this)">ğŸ“œ Ø§Ù„Ù‚ÙˆØ§Ù†ÙŠÙ†</div>
    </div>

    <div id="leaderboard" class="tab-content" style="padding: 20px;">
        <button class="play-btn" onclick="launchGame()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ù†Ø§ÙØ³Ø© âš”ï¸</button>
        <div id="list-container"></div>
    </div>

    <div id="info" class="tab-content hidden" style="padding: 40px 20px;">
        <h2 style="color:var(--gold)">ÙƒÙŠÙ ØªØµØ¨Ø­ Ø§Ù„Ù‚ÙˆØªØŸ</h2>
        <p>1. Ø£Ø¬Ø¨ Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© (6/6).</p>
        <p>2. Ø­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ø­ÙŠÙˆØ§ØªÙƒ ÙƒØ§Ù…Ù„Ø© â¤ï¸.</p>
        <p>3. ÙƒÙ† Ø§Ù„Ø£Ø³Ø±Ø¹ ÙÙŠ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¨Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ â±ï¸.</p>
    </div>

    <div id="game-overlay">
        <div style="font-size: 2.5rem;" id="game-hearts">â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸</div>
        <div style="font-size: 4rem; color: var(--gold); font-weight: 900;" id="game-timer">0s</div>
        <h2 id="q-txt" style="padding: 20px;"></h2>
        <div id="opts-container" style="width: 100%;"></div>
    </div>

<script>
    const BIN_ID = '698ec55bd0ea881f40b6b5e3'; 
    const API_KEY = '$2a$10$zP2nglkzKrG1K81/D3uY1ejRP73C/zxIpE9QiFtYPOS2pU9saHnU.'; 
    
    const bgM = document.getElementById('bgMusic');
    [bgM, document.getElementById('winSnd'), document.getElementById('loseSnd')].forEach(s => s.volume = 0.35);

    function startMusicOnce() { if(bgM.paused) bgM.play(); }

    function showTab(id, el) {
        document.querySelectorAll('.tab-content').forEach(t => t.classList.add('hidden'));
        document.querySelectorAll('.tab-item').forEach(t => t.classList.remove('active'));
        document.getElementById(id).classList.remove('hidden');
        el.classList.add('active');
    }

    const quizData = [
        {q: "Ù…Ø§ Ù‡Ùˆ Ø£ØµÙ„ Ø§Ø³Ù… ÙƒÙˆÙƒØ¨ Ø§Ù„Ø£Ø±Ø¶ Ø¨Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©ØŸ", a: ["Ø¬Ø±Ù…Ø§Ù†ÙŠ", "Ù„Ø§ØªÙŠÙ†ÙŠ", "ÙŠÙˆÙ†Ø§Ù†ÙŠ"], c: 0},
        {q: "Ø£ÙŠ ØºØ§Ø² Ù‡Ùˆ Ø§Ù„Ø£ÙƒØ«Ø± ØªÙˆØ§Ø¬Ø¯Ø§Ù‹ ÙÙŠ Ø§Ù„ØºÙ„Ø§Ù Ø§Ù„Ø¬ÙˆÙŠØŸ", a: ["Ø§Ù„Ø£ÙƒØ³Ø¬ÙŠÙ†", "Ø§Ù„Ù†ÙŠØªØ±ÙˆØ¬ÙŠÙ†", "Ø§Ù„Ù‡ÙŠØ¯Ø±ÙˆØ¬ÙŠÙ†"], c: 1},
        {q: "ÙƒÙ… Ø¹Ø¯Ø¯ Ø§Ù„Ù‚Ù„ÙˆØ¨ Ù„Ø¯Ù‰ Ø§Ù„Ø£Ø®Ø·Ø¨ÙˆØ·ØŸ", a: ["1", "2", "3"], c: 2},
        {q: "8 Ã— 8 Ã· 4 = ?", a: ["16", "32", "64"], c: 0},
        {q: "Ù…Ø§ Ù‡Ùˆ Ø£ØµØºØ± ÙƒÙˆÙƒØ¨ ÙÙŠ Ù…Ø¬Ù…ÙˆØ¹ØªÙ†Ø§ Ø§Ù„Ø´Ù…Ø³ÙŠØ©ØŸ", a: ["Ø§Ù„Ù…Ø±ÙŠØ®", "Ø¹Ø·Ø§Ø±Ø¯", "Ø§Ù„Ø²Ù‡Ø±Ø©"], c: 1},
        {q: "Ø£ÙŠÙ† ØªÙ‚Ø¹ Ø§Ù„ÙƒØ¹Ø¨Ø© Ø§Ù„Ù…Ø´Ø±ÙØ©ØŸ", a: ["Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù†ÙˆØ±Ø©", "Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø©", "Ø§Ù„Ø±ÙŠØ§Ø¶"], c: 1}
    ];

    let sc = 0, lv = 5, tm = 0, qi = 0, intv, uName = "";

    async function fetchData() {
        const res = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, { headers: {'X-Master-Key': API_KEY} });
        const d = await res.json();
        const players = d.record.players || [];
        if(players.length > 0) document.getElementById('top-goat-display').innerText = players[0].name;
        
        let html = "";
        players.forEach((p, i) => {
            html += `<div class="player-card ${i===0?'top-goat-card':''}">
                <div style="text-align:right"><b>${i+1}. ${p.name}</b><br><small style="color:var(--gold)">${i===0?'GOLDEN GOAT ğŸ‘‘':p.rank}</small></div>
                <div>ğŸ¯ ${p.score}/6 | â±ï¸ ${p.time}s</div>
            </div>`;
        });
        document.getElementById('list-container').innerHTML = html;
    }

    function launchGame() {
        uName = prompt("Ø§Ø³Ù…Ùƒ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„ØªØ§Ø±ÙŠØ®:");
        if(!uName) return;
        sc = 0; lv = 5; tm = 0; qi = 0;
        document.getElementById('game-overlay').style.display = 'flex';
        intv = setInterval(() => { tm++; document.getElementById('game-timer').innerText = tm + "s"; }, 1000);
        showQ();
    }

    function showQ() {
        if(qi >= 6 || lv <= 0) return end();
        const q = quizData.sort(() => Math.random() - 0.5)[qi]; // Ø®Ù„Ø· Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
        document.getElementById('q-txt').innerText = q.q;
        const box = document.getElementById('opts-container');
        box.innerHTML = "";
        q.a.forEach((opt, i) => {
            const b = document.createElement('button');
            b.className = "option-btn"; b.innerText = opt;
            b.onclick = () => { if(i === q.c) sc++; else { lv--; document.getElementById('game-hearts').innerText = "â¤ï¸".repeat(lv); } qi++; showQ(); };
            box.appendChild(b);
        });
    }

    async function end() {
        clearInterval(intv);
        document.getElementById('game-overlay').style.display = 'none';
        if(lv > 0) { document.getElementById('winSnd').play(); confetti(); } else { document.getElementById('loseSnd').play(); }
        
        const sortVal = (sc * 1000) + (lv * 100) - tm;
        const pObj = { name: uName, score: sc, time: tm, lives: lv, rank: "Ù…Ø­Ø§Ø±Ø¨", sortVal };

        const res = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, { headers: {'X-Master-Key': API_KEY} });
        const d = await res.json();
        let list = d.record.players || [];
        list.push(pObj);
        list.sort((a,b) => b.sortVal - a.sortVal);
        
        await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}`, {
            method: 'PUT',
            headers: {'Content-Type': 'application/json', 'X-Master-Key': API_KEY},
            body: JSON.stringify({ players: list.slice(0, 20) })
        });
        fetchData();
    }

    window.onload = fetchData;
</script>
</body>
</html>

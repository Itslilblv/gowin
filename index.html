<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gowin Pro - Arena Ultimate</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --gold: #ffd700;
            --bg-dark: #080a0f;
            --glass: rgba(255, 255, 255, 0.03);
            --border: rgba(255, 215, 0, 0.2);
        }

        body {
            margin: 0; background-color: var(--bg-dark); color: white;
            font-family: 'Cairo', sans-serif; overflow-x: hidden;
            background: radial-gradient(circle at top, #16213e 0%, #080a0f 100%);
            min-height: 100vh;
        }

        /* Ø§Ù„Ù„ÙˆØ¬Ùˆ Ø§Ù„Ù…ØªØ­Ø±Ùƒ */
        .header-section { padding: 40px 20px 10px; text-align: center; }
        .logo-glow {
            font-size: 2.5rem; font-weight: 900; color: var(--gold);
            letter-spacing: 6px; text-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
            animation: pulseGlow 3s infinite alternate;
        }
        @keyframes pulseGlow {
            from { transform: scale(1); opacity: 0.8; text-shadow: 0 0 10px var(--gold); }
            to { transform: scale(1.05); opacity: 1; text-shadow: 0 0 30px var(--gold); }
        }

        /* Ø¨Ø§Ù†Ø± Ø§Ù„Ù‚ÙˆØª Ø§Ù„Ø°Ù‡Ø¨ÙŠ */
        .goat-status {
            background: linear-gradient(90deg, transparent, var(--gold), transparent);
            color: black; padding: 8px; font-weight: 900; font-size: 1rem;
            margin: 15px 0 25px; box-shadow: 0 4px 20px rgba(0,0,0,0.4);
        }

        /* Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª (Arena Navigation) */
        .arena-tabs {
            display: flex; background: var(--glass); margin: 0 20px 20px;
            border-radius: 15px; padding: 5px; border: 1px solid rgba(255,255,255,0.05);
        }
        .tab-trigger {
            flex: 1; padding: 12px; border: none; background: none; color: #777;
            font-weight: 700; cursor: pointer; transition: 0.3s; border-radius: 12px;
        }
        .tab-trigger.active { background: var(--gold); color: black; }

        /* Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ© */
        .content-area { padding: 0 20px 100px; }
        .arena-card {
            background: var(--glass); backdrop-filter: blur(12px);
            border: 1px solid rgba(255,255,255,0.08);
            margin-bottom: 12px; padding: 18px; border-radius: 20px;
            display: flex; justify-content: space-between; align-items: center;
            transition: 0.3s;
        }
        .arena-card.golden-goat {
            border: 1px solid var(--gold);
            background: rgba(255, 215, 0, 0.08);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.1);
        }

        .rank-badge {
            width: 32px; height: 32px; background: rgba(255,255,255,0.05);
            border-radius: 8px; display: flex; align-items: center; justify-content: center;
            font-weight: 900; color: var(--gold); margin-left: 15px;
        }

        /* Ø²Ø± Ø§Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ø§Ø¦Ù… */
        .btn-play {
            background: var(--gold); color: black; padding: 18px 40px;
            border: none; border-radius: 15px; font-weight: 900; font-size: 1.2rem;
            width: 100%; max-width: 400px; cursor: pointer;
            box-shadow: 0 10px 25px rgba(255,215,0,0.2); margin: 10px 0 30px;
        }

        /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ØªØ­Ø¯ÙŠ */
        #arena-game-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-dark); z-index: 9999; display: none;
            flex-direction: column; align-items: center; justify-content: center;
        }
        .q-card {
            width: 85%; max-width: 450px; background: var(--glass);
            padding: 30px; border-radius: 25px; border: 1px solid var(--border);
            text-align: center;
        }
        .opt-btn {
            width: 100%; padding: 18px; margin: 10px 0;
            background: rgba(255,255,255,0.05); border: 1px solid rgba(255,215,0,0.2);
            color: white; border-radius: 15px; cursor: pointer; font-size: 1.1rem;
            font-weight: 700; transition: 0.2s;
        }
        .opt-btn:hover { background: var(--gold); color: black; }

        .hidden { display: none !important; }
    </style>
</head>
<body onclick="handleFirstClick()">

    <audio id="musicBg" loop src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-15.mp3"></audio>
    <audio id="sndWin" src="https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3"></audio>
    <audio id="sndLose" src="https://assets.mixkit.co/active_storage/sfx/2019/2019-preview.mp3"></audio>

    <div class="header-section">
        <div class="logo-glow">GOWIN PRO</div>
    </div>

    <div class="goat-status">ğŸ† THE GOLDEN GOAT: <span id="top-goat-name">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©...</span></div>

    <div class="arena-tabs">
        <button class="tab-trigger active" onclick="toggleTab('rank', this)">ğŸ† Ø§Ù„Ù…ØªØµØ¯Ø±ÙˆÙ†</button>
        <button class="tab-trigger" onclick="toggleTab('how', this)">ğŸ“– Ø§Ù„Ø´Ø±ÙˆØ·</button>
    </div>

    <div class="content-area">
        <div id="view-rank">
            <button class="btn-play" onclick="startArena()">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ø¯ÙŠ Ø§Ù„ÙÙˆØ±ÙŠ âš”ï¸</button>
            <div id="leaderboard-data"></div>
        </div>

        <div id="view-how" class="hidden" style="text-align: right; line-height: 1.8;">
            <h3 style="color: var(--gold)">Ù‚ÙˆØ§Ù†ÙŠÙ† Ø§Ù„Ø³Ø§Ø­Ø©:</h3>
            <p>â€¢ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© ØªÙ…Ù†Ø­Ùƒ 1000 Ù†Ù‚Ø·Ø©.</p>
            <p>â€¢ ÙƒÙ„ Ù‚Ù„Ø¨ Ù…ØªØ¨Ù‚ÙŠ ÙŠÙ…Ù†Ø­Ùƒ 100 Ù†Ù‚Ø·Ø© Ø¥Ø¶Ø§ÙÙŠØ©.</p>
            <p>â€¢ ÙŠØªÙ… Ø®ØµÙ… Ø«Ø§Ù†ÙŠØ© ÙˆØ§Ø­Ø¯Ø© Ù…Ù† Ù†Ù‚Ø§Ø·Ùƒ Ù„ÙƒÙ„ Ø«Ø§Ù†ÙŠØ© ØªØ£Ø®ÙŠØ±.</p>
            <p>â€¢ "Ø§Ù„Ù‚ÙˆØª Ø§Ù„Ø°Ù‡Ø¨ÙŠ" Ù‡Ùˆ ØµØ§Ø­Ø¨ Ø£Ø¹Ù„Ù‰ Ø±Ù‚Ù… Ù‚ÙŠØ§Ø³ÙŠ ØªØ§Ø±ÙŠØ®ÙŠ.</p>
        </div>
    </div>

    <div id="arena-game-overlay">
        <div style="margin-bottom: 20px; text-align: center;">
            <div id="lives-counter" style="font-size: 2rem; letter-spacing: 5px;">â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸</div>
            <div id="time-counter" style="font-size: 4rem; font-weight: 900; color: var(--gold);">0s</div>
        </div>
        <div class="q-card">
            <h2 id="q-text" style="margin-bottom: 25px;"></h2>
            <div id="options-box"></div>
        </div>
    </div>

<script>
    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø¨Ø· (Bin ID & Key)
    const B_ID = '698ec55bd0ea881f40b6b5e3';
    const B_KEY = '$2a$10$zP2nglkzKrG1K81/D3uY1ejRP73C/zxIpE9QiFtYPOS2pU9saHnU.';

    const audios = {
        bg: document.getElementById('musicBg'),
        win: document.getElementById('sndWin'),
        lose: document.getElementById('sndLose')
    };
    Object.values(audios).forEach(a => a.volume = 0.35);

    function handleFirstClick() { if(audios.bg.paused) audios.bg.play().catch(()=>{}); }

    function toggleTab(view, btn) {
        document.getElementById('view-rank').classList.add('hidden');
        document.getElementById('view-how').classList.add('hidden');
        document.querySelectorAll('.tab-trigger').forEach(b => b.classList.remove('active'));
        document.getElementById('view-'+view).classList.remove('hidden');
        btn.classList.add('active');
    }

    const arenaQuestions = [
        {q: "Ù…Ø§ Ù‡Ùˆ Ø£Ø³Ø±Ø¹ ÙƒØ§Ø¦Ù† Ø­ÙŠ ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ", a: ["Ø§Ù„ÙÙ‡Ø¯", "Ø§Ù„Ù†Ø¹Ø§Ù…Ø©", "Ø§Ù„ØµÙ‚Ø± Ø§Ù„Ø¬ÙˆØ§Ù„"], c: 2},
        {q: "ÙƒÙ… Ù‚Ù„Ø¨ ÙŠÙ…ØªÙ„Ùƒ Ø§Ù„Ø£Ø®Ø·Ø¨ÙˆØ·ØŸ", a: ["Ù‚Ù„Ø¨ ÙˆØ§Ø­Ø¯", "Ø«Ù„Ø§Ø«Ø© Ù‚Ù„ÙˆØ¨", "Ø®Ù…Ø³Ø© Ù‚Ù„ÙˆØ¨"], c: 1},
        {q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ù…Ø¹Ø¯Ù† Ø§Ù„Ø³Ø§Ø¦Ù„ Ø§Ù„ÙˆØ­ÙŠØ¯ØŸ", a: ["Ø§Ù„Ù†Ø­Ø§Ø³", "Ø§Ù„Ø²Ø¦Ø¨Ù‚", "Ø§Ù„Ù‚ØµØ¯ÙŠØ±"], c: 1},
        {q: "Ø£ÙŠÙ† ØªÙ‚Ø¹ Ø£ÙƒØ¨Ø± ØµØ­Ø±Ø§Ø¡ ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ", a: ["Ø§Ù„ØµØ­Ø±Ø§Ø¡ Ø§Ù„ÙƒØ¨Ø±Ù‰", "Ø£Ù†ØªØ§Ø±ÙƒØªÙŠÙƒØ§", "ØµØ­Ø±Ø§Ø¡ Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø®Ø§Ù„ÙŠ"], c: 1},
        {q: "Ù…Ø§ Ù‡Ùˆ Ø±Ù…Ø² Ø§Ù„Ù…Ø§Ø¡ Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¦ÙŠØŸ", a: ["CO2", "H2O", "O2"], c: 1},
        {q: "ÙƒÙ… Ø¹Ø¯Ø¯ Ø§Ù„Ù‚Ø§Ø±Ø§Øª ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ", a: ["6", "7", "5"], c: 1}
    ];

    let score=0, hearts=5, clock=0, qIdx=0, timerRef, userName="";

    async function loadLeaderboard() {
        try {
            const res = await fetch(`https://api.jsonbin.io/v3/b/${B_ID}/latest`, {headers: {'X-Master-Key': B_KEY}});
            const data = await res.json();
            const players = data.record.players || [];
            if(players.length > 0) document.getElementById('top-goat-name').innerText = players[0].name;
            
            let listHtml = "";
            players.forEach((p, i) => {
                const isTop = i === 0 ? 'golden-goat' : '';
                listHtml += `
                <div class="arena-card ${isTop}">
                    <div style="display:flex; align-items:center;">
                        <div class="rank-badge">${i+1}</div>
                        <div style="text-align:right">
                            <b style="font-size:1.1rem">${p.name}</b><br>
                            <small style="color:var(--gold)">${i===0 ? 'GOLDEN GOAT ğŸ‘‘' : 'ARENA ELITE'}</small>
                        </div>
                    </div>
                    <div style="text-align:left">
                        <span style="font-weight:900">${p.score}/6</span><br>
                        <small style="color:#666">${p.time}s</small>
                    </div>
                </div>`;
            });
            document.getElementById('leaderboard-data').innerHTML = listHtml;
        } catch(e) { console.log("Error loading"); }
    }

    function startArena() {
        userName = prompt("Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ø§Ø±Ø¨:");
        if(!userName) return;
        score=0; hearts=5; clock=0; qIdx=0;
        document.getElementById('arena-game-overlay').style.display = 'flex';
        timerRef = setInterval(() => { clock++; document.getElementById('time-counter').innerText = clock + "s"; }, 1000);
        showQuestion();
    }

    function showQuestion() {
        if(qIdx >= 6 || hearts <= 0) return endArena();
        const q = arenaQuestions.sort(() => Math.random() - 0.5)[qIdx];
        document.getElementById('q-text').innerText = q.q;
        const box = document.getElementById('options-box');
        box.innerHTML = "";
        q.a.forEach((opt, i) => {
            const btn = document.createElement('button');
            btn.className = "opt-btn";
            btn.innerText = opt;
            btn.onclick = () => {
                if(i === q.c) score++; else { hearts--; document.getElementById('lives-counter').innerText = "â¤ï¸".repeat(hearts); }
                qIdx++; showQuestion();
            };
            box.appendChild(btn);
        });
    }

    async function endArena() {
        clearInterval(timerRef);
        document.getElementById('arena-game-overlay').style.display = 'none';
        if(hearts > 0) { audios.win.play(); confetti(); } else { audios.lose.play(); }

        const sortPower = (score * 1000) + (hearts * 100) - clock;
        const result = { name: userName, score, time: clock, hearts, sortVal: sortPower };

        try {
            const res = await fetch(`https://api.jsonbin.io/v3/b/${B_ID}/latest`, {headers: {'X-Master-Key': B_KEY}});
            const d = await res.json();
            let players = d.record.players || [];
            players.push(result);
            players.sort((a,b) => b.sortVal - a.sortVal);
            await fetch(`https://api.jsonbin.io/v3/b/${B_ID}`, {
                method: 'PUT',
                headers: {'Content-Type': 'application/json', 'X-Master-Key': B_KEY},
                body: JSON.stringify({ players: players.slice(0, 20) })
            });
            loadLeaderboard();
        } catch(e) {}
    }

    window.onload = loadLeaderboard;
</script>
</body>
</html>
